const C=e=>({run:e,map:t=>C(()=>t(e())),chain:t=>C(()=>t(e()).run())});C.of=e=>C(()=>e);C.map=e=>t=>t.map(e);C.chain=e=>t=>t.chain(e);C.run=e=>e.run();const z=e=>({_tag:"Left",left:e}),w=e=>({_tag:"Right",right:e}),se=(e,t)=>t._tag==="Right"?w(e(t.right)):t,ie=(e,t)=>t._tag==="Right"?e(t.right):t,oe=(e,t,i)=>i._tag==="Left"?e(i.left):t(i.right),ue=e=>w(e),j={Left:z,Right:w,map:se,chain:ie,fold:oe,of:ue},_=e=>({run:e,map:t=>_(i=>t(e(i))),chain:t=>_(i=>t(e(i)).run(i))});_.of=e=>_(()=>e);_.ask=()=>_(e=>e);_.map=e=>t=>t.map(e);_.chain=e=>t=>t.chain(e);_.run=e=>t=>t.run(e);const S=e=>({run:e,map:t=>S(()=>{const[i,r]=e();return[t(i),r]}),chain:t=>S(()=>{const[i,r]=e(),[c,g]=t(i).run(),m=Array.isArray(r)?[...r,...g]:g;return[c,m]})});S.of=(e,t)=>S(()=>[e,t]);S.tell=e=>S(()=>[void 0,e]);S.updateValueAndLog=(e,t)=>e.chain(i=>S(()=>[i,[t]]));const R=e=>({run:e,map:t=>R(()=>e().then(i=>i._tag==="Right"?w(t(i.right)):i)),chain:t=>R(()=>e().then(i=>i._tag==="Right"?t(i.right).run():Promise.resolve(i)))});R.of=e=>R(()=>Promise.resolve(w(e)));R.reject=e=>R(()=>Promise.resolve(z(e)));R.tryCatch=e=>R(()=>e().then(w).catch(z));const ce=e=>(t,i)=>{let r;const c=[];let g=!1;const m=u=>u?.forEach(f=>f.run()),d=u=>{const{model:f,effects:o}=i.update(u,r,s);r=f,e(t,i.view(r,s)),m(o)},s=u=>{c.push(u),g||(g=!0,requestAnimationFrame(()=>{g=!1;const f=c.splice(0,c.length);for(const o of f)d(o)}))};return(()=>{const{model:u,effects:f}=i.init.run();r=u,e(t,i.view(r,s)),m(f)})(),{dispatch:s}},I=_(e=>e);I.map(e=>e.document);I.map(e=>e.window);I.map(e=>e.localStorage);I.map(e=>e.fetch);const le=(e,t)=>e.run(t).run(),fe=()=>({document,window,localStorage,fetch}),X=(e,t)=>_(i=>R(async()=>{try{const r=await i.fetch(`${i.baseUrl??""}${e}`,t);if(!r.ok)return j.Left({status:r.status,message:r.statusText||"HTTP error"});const c=await r.json();return j.Right(c)}catch(r){return j.Left({message:r instanceof Error?r.message:String(r)})}}));function B(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function pe(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var i=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var c=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(i,r,c.get?c:{enumerable:!0,get:function(){return e[r]}})}),i}var V,J;function he(){if(J)return V;J=1,r.notEqual=t,r.notOk=i,r.equal=e,r.ok=r,V=r;function e(c,g,m){r(c==g,m)}function t(c,g,m){r(c!=g,m)}function i(c,g){r(!c,g)}function r(c,g){if(!c)throw new Error(g||"AssertionError")}return V}var F,Z;function ge(){return Z||(Z=1,F=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","onanimationend","onanimationiteration","onanimationstart","oncontextmenu","onfocusin","onfocusout"]),F}var H,K;function de(){if(K)return H;K=1;var e=ge(),t=e.length,i=1,r=3,c=8;H=g;function g(o,n){var p=o.nodeType,a=o.nodeName;p===i&&m(o,n),(p===r||p===c)&&n.nodeValue!==o.nodeValue&&(n.nodeValue=o.nodeValue),a==="INPUT"?l(o,n):a==="OPTION"?s(o,n):a==="TEXTAREA"&&u(o,n),d(o,n)}function m(o,n){for(var p=n.attributes,a=o.attributes,h=null,x=null,v=null,y=null,T=null,b=a.length-1;b>=0;--b)T=a[b],y=T.name,h=T.namespaceURI,x=T.value,h?(y=T.localName||y,v=n.getAttributeNS(h,y),v!==x&&n.setAttributeNS(h,y,x)):n.hasAttribute(y)?(v=n.getAttribute(y),v!==x&&(x==="null"||x==="undefined"?n.removeAttribute(y):n.setAttribute(y,x))):n.setAttribute(y,x);for(var E=p.length-1;E>=0;--E)T=p[E],T.specified!==!1&&(y=T.name,h=T.namespaceURI,h?(y=T.localName||y,o.hasAttributeNS(h,y)||n.removeAttributeNS(h,y)):o.hasAttributeNS(null,y)||n.removeAttribute(y))}function d(o,n){for(var p=0;p<t;p++){var a=e[p];o[a]?n[a]=o[a]:n[a]&&(n[a]=void 0)}}function s(o,n){f(o,n,"selected")}function l(o,n){var p=o.value,a=n.value;f(o,n,"checked"),f(o,n,"disabled"),o.indeterminate!==n.indeterminate&&(n.indeterminate=o.indeterminate),n.type!=="file"&&(p!==a&&(n.setAttribute("value",p),n.value=p),p==="null"&&(n.value="",n.removeAttribute("value")),o.hasAttributeNS(null,"value")?n.type==="range"&&(n.value=p):n.removeAttribute("value"))}function u(o,n){var p=o.value;if(p!==n.value&&(n.value=p),n.firstChild&&n.firstChild.nodeValue!==p){if(p===""&&n.firstChild.nodeValue===n.placeholder)return;n.firstChild.nodeValue=p}}function f(o,n,p){o[p]!==n[p]&&(n[p]=o[p],o[p]?n.setAttribute(p,""):n.removeAttribute(p))}return H}var M,Q;function me(){if(Q)return M;Q=1;var e=he(),t=de(),i=3;M=r;function r(s,l,u){return e.equal(typeof s,"object","nanomorph: oldTree should be an object"),e.equal(typeof l,"object","nanomorph: newTree should be an object"),u&&u.childrenOnly?(m(l,s),s):(e.notEqual(l.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),c(l,s))}function c(s,l){return l?s?s.isSameNode&&s.isSameNode(l)?l:s.tagName!==l.tagName||g(s)!==g(l)?s:(t(s,l),m(s,l),l):null:s}function g(s){return s.dataset?s.dataset.nanomorphComponentId:void 0}function m(s,l){for(var u,f,o,n,p=0,a=0;u=l.childNodes[a],f=s.childNodes[a-p],!(!u&&!f);a++)if(!f)l.removeChild(u),a--;else if(!u)l.appendChild(f),p++;else if(d(f,u))o=c(f,u),o!==u&&(l.replaceChild(o,u),p++);else{n=null;for(var h=a;h<l.childNodes.length;h++)if(d(l.childNodes[h],f)){n=l.childNodes[h];break}n?(o=c(f,n),o!==n&&p++,l.insertBefore(o,u)):!f.id&&!u.id?(o=c(f,u),o!==u&&(l.replaceChild(o,u),p++)):(l.insertBefore(f,u),p++)}}function d(s,l){return s.id?s.id===l.id:s.isSameNode?s.isSameNode(l):s.tagName!==l.tagName?!1:s.type===i?s.nodeValue===l.nodeValue:!1}return M}var ve=me();const be=B(ve);var L={exports:{}},Y;function ye(){return Y||(Y=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(s){return typeof s=="string"&&s.length>0},r=function(s,l){return s[0]===l},c=function(s){return i(s)&&(r(s,".")||r(s,"#"))},g=function(s){return function(l){return function(u){for(var f=arguments.length,o=Array(f>1?f-1:0),n=1;n<f;n++)o[n-1]=arguments[n];return c(u)?s.apply(void 0,[l+u].concat(o)):typeof u>"u"?s(l):s.apply(void 0,[l,u].concat(o))}}},m=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","element","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","image","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","math","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rb","rbc","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"];t.default=function(d){var s=g(d),l={TAG_NAMES:m,isSelector:c,createTag:s};return m.forEach(function(u){l[u]=s(u)}),l},e.exports=t.default})(L,L.exports)),L.exports}var Ee=ye();const xe=B(Ee);var D={exports:{}};/*!
 * Cross-Browser Split 1.1.1
 * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>
 * Available under the MIT License
 * ECMAScript compliant, uniform cross-browser split method
 */var U,N;function Te(){return N||(N=1,U=(function(t){var i=String.prototype.split,r=/()??/.exec("")[1]===t,c;return c=function(g,f,d){if(Object.prototype.toString.call(f)!=="[object RegExp]")return i.call(g,f,d);var s=[],l=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.extended?"x":"")+(f.sticky?"y":""),u=0,f=new RegExp(f.source,l+"g"),o,n,p,a;for(g+="",r||(o=new RegExp("^"+f.source+"$(?!\\s)",l)),d=d===t?-1>>>0:d>>>0;(n=f.exec(g))&&(p=n.index+n[0].length,!(p>u&&(s.push(g.slice(u,n.index)),!r&&n.length>1&&n[0].replace(o,function(){for(var h=1;h<arguments.length-2;h++)arguments[h]===t&&(n[h]=t)}),n.length>1&&n.index<g.length&&Array.prototype.push.apply(s,n.slice(1)),a=n[0].length,u=p,s.length>=d)));)f.lastIndex===n.index&&f.lastIndex++;return u===g.length?(a||!f.test(""))&&s.push(""):s.push(g.slice(u)),s.length>d?s.slice(0,d):s},c})()),U}var G,ee;function _e(){if(ee)return G;ee=1;var e=[].indexOf;return G=function(t,i){if(e)return t.indexOf(i);for(var r=0;r<t.length;++r)if(t[r]===i)return r;return-1},G}var k,te;function Ce(){if(te)return k;te=1;var e=_e();k=t;function t(c){var g=c.classList;if(g)return g;var m={add:d,remove:s,contains:l,toggle:u,toString:f,length:0,item:o};return m;function d(a){var h=n();e(h,a)>-1||(h.push(a),p(h))}function s(a){var h=n(),x=e(h,a);x!==-1&&(h.splice(x,1),p(h))}function l(a){return e(n(),a)>-1}function u(a){return l(a)?(s(a),!1):(d(a),!0)}function f(){return c.className}function o(a){var h=n();return h[a]||null}function n(){var a=c.className;return i(a.split(" "),r)}function p(a){var h=a.length;c.className=a.join(" "),m.length=h;for(var x=0;x<a.length;x++)m[x]=a[x];delete a[h]}}function i(c,g){for(var m=[],d=0;d<c.length;d++)g(c[d])&&m.push(c[d]);return m}function r(c){return!!c}return k}const Se={},Ae=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"})),Re=pe(Ae);var ne;function Oe(){if(ne)return D.exports;ne=1;var e=Te(),t=Ce(),i=typeof window>"u"?Re:window,r=i.document,c=i.Text;function g(){var u=[];function f(){var o=[].slice.call(arguments),n=null;function p(a){var h;function x(b){var E=e(b,/([\.#]?[^\s#.]+)/);/^\.|#/.test(E[1])&&(n=r.createElement("div")),s(E,function(A){var q=A.substring(1,A.length);A&&(n?A[0]==="."?t(n).add(q):A[0]==="#"&&n.setAttribute("id",q):n=r.createElement(A))})}if(a!=null){if(typeof a=="string")n?n.appendChild(h=r.createTextNode(a)):x(a);else if(typeof a=="number"||typeof a=="boolean"||a instanceof Date||a instanceof RegExp)n.appendChild(h=r.createTextNode(a.toString()));else if(l(a))s(a,p);else if(d(a))n.appendChild(h=a);else if(a instanceof c)n.appendChild(h=a);else if(typeof a=="object")for(var v in a)if(typeof a[v]=="function")/^on\w+/.test(v)?(function(b,E){n.addEventListener?(n.addEventListener(b.substring(2),E[b],!1),u.push(function(){n.removeEventListener(b.substring(2),E[b],!1)})):(n.attachEvent(b,E[b]),u.push(function(){n.detachEvent(b,E[b])}))})(v,a):(n[v]=a[v](),u.push(a[v](function(b){n[v]=b})));else if(v==="style")if(typeof a[v]=="string")n.style.cssText=a[v];else for(var y in a[v])(function(b,E){if(typeof E=="function")n.style.setProperty(b,E()),u.push(E(function(q){n.style.setProperty(b,q)}));else var A=a[v][b].match(/(.*)\W+!important\W*$/);A?n.style.setProperty(b,A[1],"important"):n.style.setProperty(b,a[v][b])})(y,a[v][y]);else if(v==="attrs")for(var T in a[v])n.setAttribute(T,a[v][T]);else v.substr(0,5)==="data-"?n.setAttribute(v,a[v]):n[v]=a[v];else if(typeof a=="function"){var T=a();n.appendChild(h=d(T)?T:r.createTextNode(T)),u.push(a(function(E){d(E)&&h.parentElement?(h.parentElement.replaceChild(E,h),h=E):h.textContent=E}))}}return h}for(;o.length;)p(o.shift());return n}return f.cleanup=function(){for(var o=0;o<u.length;o++)u[o]();u.length=0},f}var m=D.exports=g();m.context=g;function d(u){return u&&u.nodeName&&u.nodeType}function s(u,f){if(u.forEach)return u.forEach(f);for(var o=0;o<u.length;o++)f(u[o],o)}function l(u){return Object.prototype.toString.call(u)=="[object Array]"}return D.exports}var we=Oe();const qe=B(we);let P=null;const Le=(e,t)=>{P?P=be(P,t):(e.appendChild(t),P=t)},{div:W,h1:re,h2:We,p:Pe,button:$,section:ae,input:Xe,ul:$e,li:Ie,span:je}=xe(qe),Ve=C(()=>{const e={fetch:globalThis.fetch,baseUrl:"https://jsonplaceholder.typicode.com"},t={data:[],loading:!1,page:1,limit:10};return{model:{theme:"light",env:e,active:"posts",logs:S.of("",[]),posts:t,users:t,comments:t,albums:t,photos:t,todos:t},effects:[]}}),Fe=(e,t,i)=>{switch(e.type){case"SET_ACTIVE":return{model:{...t,active:e.key}};case"FETCH_RESOURCE":{const r=e.key,{limit:c}=t[r],g=X(`/${r}?_page=1&_limit=${c}`).run(t.env),m=C(async()=>{const d=await g.run();d._tag==="Right"?i({type:"FETCH_SUCCESS",key:r,data:d.right,page:1}):i({type:"FETCH_ERROR",key:r,error:"status"in d.left?d.left:{status:0,message:d.left.message}})});return{model:{...t,[r]:{...t[r],loading:!0}},effects:[m]}}case"FETCH_PAGE":{const r=e.key,c=e.page,{limit:g}=t[r],m=X(`/${r}?_page=${c}&_limit=${g}`).run(t.env),d=C(async()=>{const s=await m.run();s._tag==="Right"?i({type:"FETCH_SUCCESS",key:r,data:s.right,page:c}):i({type:"FETCH_ERROR",key:r,error:"status"in s.left?s.left:{status:0,message:s.left.message}})});return{model:{...t,[r]:{...t[r],loading:!0}},effects:[d]}}case"FETCH_SUCCESS":{const r=e.key,c=t.logs.chain(()=>S(()=>["",[`Fetched ${r} page ${e.page||1}`]]));return{model:{...t,[r]:{...t[r],data:[...e.data],loading:!1,page:e.page||1},logs:c}}}case"FETCH_ERROR":{const r=t.logs.chain(()=>S(()=>["",[`Error fetching ${e.key}: ${e.error}`]]));return{model:{...t,[e.key]:{...t[e.key],loading:!1,error:e.error},logs:r}}}case"TOGGLE_THEME":{const r=t.theme==="light"?"dark":"light";return document.documentElement.classList.toggle("dark",r==="dark"),{model:{...t,theme:r}}}default:return{model:t}}},O=(e,t,i)=>{const{data:r,page:c,limit:g,loading:m,error:d}=t,s=c+1,l=c-1,u=t.data.length||t.loading||t.error;return ae({className:"p-4 border rounded"},[re({className:"text-lg font-bold mb-2 capitalize"},e),$({className:"bg-blue-600 text-white px-3 py-1 rounded mb-3",onclick:()=>i({type:"FETCH_RESOURCE",key:e})},t.loading?"Loading...":"Fetch"),u&&W({className:"flex items-center gap-3 mt-3"},[$({id:`${String(e)}-prev-${l}`,className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed",disabled:t.page===1||t.loading,onclick:()=>i({type:"FETCH_PAGE",key:e,page:t.page-1})},"Prev"),je({className:"text-sm"},`Page ${t.page}`),$({id:`${String(e)}-next-${s}`,className:"px-3 py-1 bg-gray-200 rounded",onclick:()=>i({type:"FETCH_PAGE",key:e,page:t.page+1})},"Next")]),t.error&&Pe({className:"text-red-600"},`Error: ${t.error}`),$e({className:"text-sm space-y-1"},t.data.map(f=>Ie({className:"border-b pb-1"},JSON.stringify(f))))])},He=(e,t)=>W({className:"grid grid-cols-2 gap-4"},[O("posts",e.posts,t),O("users",e.users,t),O("comments",e.comments,t),O("todos",e.todos,t),O("albums",e.albums,t),O("photos",e.photos,t)]),Me=(e,t)=>ae({className:"p-6 space-y-6"},[W({className:"flex justify-between items-center"},[re({className:"text-3xl font-bold"},"Effects-Lab Dashboard"),$({className:"bg-gray-800 text-white px-4 py-2 rounded",onclick:()=>t({type:"TOGGLE_THEME"})},`Theme: ${e.theme}`)]),He(e,t)]),De={init:Ve,update:Fe,view:Me},Ue=e=>_(t=>C(()=>{const i=()=>e({type:"RESIZE",width:t.window.innerWidth,height:t.window.innerHeight});return t.window.addEventListener("resize",i),i(),()=>t.window.removeEventListener("resize",i)})),Ge=document.getElementById("app"),ke=window.__INITIAL_MODEL__,ze=ce(Le)(Ge,{...De,init:{run:()=>({model:ke,effects:[]})}}),Be=Ue(ze.dispatch);le(Be,fe());
